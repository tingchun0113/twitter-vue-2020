{"version":3,"sources":["webpack:///./src/views/chatRoom.vue?25f3","webpack:///./public/images/send.png","webpack:///./src/components/chatModal.vue?c25c","webpack:///./src/views/chatRoom.vue?0ae9","webpack:///./src/components/chatModal.vue?6d97","webpack:///./src/apis/chat.js","webpack:///src/components/chatModal.vue","webpack:///./src/components/chatModal.vue?ce62","webpack:///./src/components/chatModal.vue","webpack:///src/views/chatRoom.vue","webpack:///./src/views/chatRoom.vue?2441","webpack:///./src/views/chatRoom.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","_v","_e","_l","user","key","id","staticClass","_f","avatar","_s","name","message","userId","currentUser","class","time","on","$event","stopPropagation","preventDefault","sendMessage","directives","rawName","value","expression","domProps","target","composing","_m","get","mixins","components","Spinner","computed","joinChatRoom","sockets","subscribe","data","onlineUsers","getChatRoomUsers","messages","push","fetchMessages","isLoading","methods","$socket","emit","trim","fire","icon","title","text","chat","getOnlineUsers","status","Error","error","console","getPublicChat","messagesData","map","d","createdAt","component","mainLeft","chatModal"],"mappings":"gHAAA,W,uBCAAA,EAAOC,QAAU,IAA0B,yB,yDCA3C,W,yCCAA,IAAIC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,cAAc,CAACF,EAAG,YAAYA,EAAG,cAAc,IACjKG,EAAkB,G,YCDlB,EAAS,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,cAAc,CAACF,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,UAAU,CAACF,EAAG,KAAK,CAACJ,EAAIQ,GAAG,WAAYR,EAAa,UAAEI,EAAG,WAAWJ,EAAIS,KAAKT,EAAIU,GAAIV,EAAe,aAAE,SAASW,GAAM,OAAOP,EAAG,MAAM,CAACQ,IAAID,EAAKE,GAAGC,YAAY,QAAQ,CAACV,EAAG,MAAM,CAACU,YAAY,SAASR,MAAM,CAAC,IAAMN,EAAIe,GAAG,aAAPf,CAAqBW,EAAKK,QAAQ,IAAM,YAAYZ,EAAG,MAAM,CAACU,YAAY,QAAQ,CAACd,EAAIQ,GAAGR,EAAIiB,GAAGN,EAAKO,eAAc,GAAGd,EAAG,MAAM,CAACE,MAAM,CAAC,GAAK,aAAa,CAAEN,EAAa,UAAEI,EAAG,WAAWJ,EAAIS,KAAKT,EAAIU,GAAIV,EAAY,UAAE,SAASmB,GAAS,OAAOf,EAAG,MAAM,CAACQ,IAAIO,EAAQN,GAAGC,YAAY,WAAW,CAAEK,EAAQC,SAAWpB,EAAIqB,YAAYR,GAAIT,EAAG,MAAM,CAACU,YAAY,SAASR,MAAM,CAAC,IAAMN,EAAIe,GAAG,aAAPf,CAAqBmB,EAAQH,QAAQ,IAAM,YAAYhB,EAAIS,KAAKL,EAAG,MAAM,CAACU,YAAY,QAAQQ,MAAM,CAACD,YAAaF,EAAQC,SAAWpB,EAAIqB,YAAYR,KAAK,CAACT,EAAG,MAAM,CAACU,YAAY,OAAO,CAACd,EAAIQ,GAAGR,EAAIiB,GAAGE,EAAQA,YAAYf,EAAG,MAAM,CAACU,YAAY,QAAQ,CAACd,EAAIQ,GAAGR,EAAIiB,GAAGjB,EAAIe,GAAG,UAAPf,CAAkBmB,EAAQI,iBAAgBnB,EAAG,OAAO,CAACoB,GAAG,CAAC,OAAS,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwB3B,EAAI4B,YAAYH,MAAW,CAACrB,EAAG,QAAQ,CAACyB,WAAW,CAAC,CAACX,KAAK,QAAQY,QAAQ,UAAUC,MAAO/B,EAAW,QAAEgC,WAAW,YAAY1B,MAAM,CAAC,KAAO,OAAO,YAAc,MAAM2B,SAAS,CAAC,MAASjC,EAAW,SAAGwB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOS,OAAOC,YAAqBnC,EAAImB,QAAQM,EAAOS,OAAOH,WAAU/B,EAAIoC,GAAG,MAAM,MACh7C,EAAkB,CAAC,WAAa,IAAIpC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACA,EAAG,MAAM,CAACE,MAAM,CAAC,IAAM,EAAQ,QAAgC,IAAM,c,gDCC7K,GACb,gBACE,OAAO,OAAU+B,IAAI,iBAEvB,iBACE,OAAO,OAAUA,IAAI,+BC8BV,GACbC,OAAQ,CAAC,OAAkB,QAC3BC,WAAY,CACVC,QAAA,QAEFC,SAAU,IACL,eAAS,CAAC,cAAe,qBAE9B,UACExC,KAAKyC,eAELzC,KAAK0C,QAAQC,UAAU,qBAAuBC,IAC1C5C,KAAK6C,YAAcD,EAAKC,cAE5B7C,KAAK8C,mBAEL9C,KAAK0C,QAAQC,UAAU,SAAWC,IAC9B5C,KAAK+C,SAASC,KAAK,CACjBpC,GAAIgC,EAAKhC,GACTM,QAAS0B,EAAK1B,QACdI,KAAMsB,EAAKtB,KACXH,OAAQyB,EAAKzB,OACbF,KAAM2B,EAAK3B,KACXF,OAAQ6B,EAAK7B,WAGnBf,KAAKiD,iBAEP,OACE,MAAO,CACL/B,QAAS,GACT6B,SAAU,GACVG,WAAW,EACXL,YAAa,KAGjBM,QAAS,CACP,eACEnD,KAAKoD,QAAQC,KAAK,qBAChBrD,KAAKoB,YAAYR,KAGrB,cACE,IAAKZ,KAAKkB,QAAQoC,OAMhB,OALA,OAAMC,KAAK,CACTC,KAAM,UACNC,MAAO,kCAETzD,KAAKkB,QAAU,IAGflB,KAAKoD,QAAQC,KAAK,SAAU,CAC1BK,KAAM1D,KAAKkB,QACXC,OAAQnB,KAAKoB,YAAYR,KAE3BZ,KAAKkB,QAAU,IAGnB,yBACE,IACElB,KAAKkD,WAAY,EACjB,MAAMN,QAAae,EAAQC,iBAE3B,GAAoB,UAAhBhB,EAAKiB,OACP,MAAM,IAAIC,MAAMlB,EAAK1B,SAGvBlB,KAAK6C,YAAcD,EAAKA,KACxB5C,KAAKkD,WAAY,EACjB,MAAOa,GACP/D,KAAKkD,WAAY,EACjBc,QAAQD,MAAMA,EAAM7C,WAGxB,sBACE,IACElB,KAAKkD,WAAY,EACjB,MAAMN,QAAae,EAAQM,gBAE3B,GAAoB,UAAhBrB,EAAKiB,OACP,MAAM,IAAIC,MAAMlB,EAAK1B,SAGvB,MAAMgD,EAAetB,EAAKA,KAC1BsB,EAAaC,IAAIC,IACfpE,KAAK+C,SAASC,KAAK,CACjBpC,GAAIwD,EAAExD,GACNM,QAASkD,EAAElD,QACXI,KAAM8C,EAAEC,UACRlD,OAAQiD,EAAEjD,OACVF,KAAMmD,EAAEnD,KACRF,OAAQqD,EAAErD,WAGdf,KAAKkD,WAAY,EACjB,MAAOa,GACP/D,KAAKkD,WAAY,EACjB,OAAMK,KAAK,CACTC,KAAM,QACNC,MAAO,kDAETO,QAAQD,MAAMA,EAAM7C,aC1IsK,I,wBCQ9LoD,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,QCTA,GACbhC,WAAY,CACViC,WAAA,KACAC,cCb6L,ICQ7L,G,UAAY,eACd,EACA1E,EACAQ,GACA,EACA,KACA,KACA,OAIa,e","file":"js/chunk-7bea8926.58cad0bf.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatRoom.vue?vue&type=style&index=0&lang=sass&\"","module.exports = __webpack_public_path__ + \"img/send.bee9a967.png\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatModal.vue?vue&type=style&index=0&lang=sass&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"mainframe\"}},[_c('mainLeft'),_c('chatModal')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"chatModal\"}},[_c('div',{attrs:{\"id\":\"rooms\"}},[_c('h5',[_vm._v(\"Chats\")]),(_vm.isLoading)?_c('Spinner'):_vm._e(),_vm._l((_vm.onlineUsers),function(user){return _c('div',{key:user.id,staticClass:\"room\"},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm._f(\"emptyImage\")(user.avatar),\"alt\":\"avatar\"}}),_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(user.name))])])})],2),_c('div',{attrs:{\"id\":\"chatting\"}},[(_vm.isLoading)?_c('Spinner'):_vm._e(),_vm._l((_vm.messages),function(message){return _c('div',{key:message.id,staticClass:\"message\"},[(message.userId !== _vm.currentUser.id)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm._f(\"emptyImage\")(message.avatar),\"alt\":\"avatar\"}}):_vm._e(),_c('div',{staticClass:\"right\",class:{currentUser: message.userId === _vm.currentUser.id}},[_c('div',{staticClass:\"msg\"},[_vm._v(_vm._s(message.message))]),_c('div',{staticClass:\"time\"},[_vm._v(_vm._s(_vm._f(\"fromNow\")(message.time)))])])])}),_c('form',{on:{\"submit\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.sendMessage($event)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Aa\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_vm._m(0)])],2)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',[_c('img',{attrs:{\"src\":require(\"../../public/images/send.png\"),\"alt\":\"send\"}})])}]\n\nexport { render, staticRenderFns }","import { apiHelper } from './../utils/helpers'\n\nexport default {\n  getPublicChat () {\n    return apiHelper.get('/chat/public')\n  },\n  getOnlineUsers () {\n    return apiHelper.get('/chat/public/online-users')\n  }\n}\n","<template>\n  <div id=\"chatModal\">\n    <div id=\"rooms\">\n      <h5>Chats</h5>\n      <Spinner v-if=\"isLoading\" />\n      <div class=\"room\" v-for=\"user in onlineUsers\" :key=\"user.id\">\n        <img class=\"avatar\" :src=\"user.avatar | emptyImage\" alt=\"avatar\">\n        <div class=\"name\">{{user.name}}</div>\n      </div>\n    </div>\n    <div id=\"chatting\">\n      <Spinner v-if=\"isLoading\" />\n      <div class=\"message\" v-for=\"message in messages\" :key=\"message.id\">\n        <img class=\"avatar\" :src=\"message.avatar | emptyImage\" alt=\"avatar\"\n          v-if=\"message.userId !== currentUser.id\">\n        <div class=\"right\" :class=\"{currentUser: message.userId === currentUser.id}\">\n          <div class=\"msg\" >{{message.message}}</div>\n          <div class=\"time\">{{message.time | fromNow }}</div>\n        </div>\n      </div>\n      <form @submit.stop.prevent=\"sendMessage\">\n        <input type=\"text\" v-model=\"message\" placeholder=\"Aa\">\n        <button>\n          <img src=\"../../public/images/send.png\" alt=\"send\">\n        </button>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { emptyImageFilter, fromNowFilter } from './../utils/mixins'\nimport Spinner from './../components/spinner'\nimport { Toast } from '../utils/helpers'\nimport chatAPI from './../apis/chat'\n\nexport default {\n  mixins: [emptyImageFilter, fromNowFilter],\n  components: {\n    Spinner\n  },\n  computed: {\n    ...mapState([\"currentUser\", \"isAuthenticated\"])\n  },\n  created () {\n    this.joinChatRoom()\n\n    this.sockets.subscribe('public-room-online', (data) => {\n        this.onlineUsers = data.onlineUsers\n    })\n    this.getChatRoomUsers()\n\n    this.sockets.subscribe('public', (data) => {\n        this.messages.push({\n          id: data.id,\n          message: data.message,\n          time: data.time,\n          userId: data.userId,\n          name: data.name,\n          avatar: data.avatar\n        })\n    }),\n    this.fetchMessages()\n  },\n  data () {\n    return {\n      message: \"\",\n      messages: [],\n      isLoading: true,\n      onlineUsers: [],\n    }\n  },\n  methods: {\n    joinChatRoom () {\n      this.$socket.emit('public-room-online',\n        this.currentUser.id,\n      )\n    },\n    sendMessage () {\n      if (!this.message.trim()) {\n        Toast.fire({\n          icon: \"warning\",\n          title: \"No message typed in chat\"\n        })\n        this.message = \"\"\n        return\n      } else {\n        this.$socket.emit('public', {\n          text: this.message,\n          userId: this.currentUser.id,\n        })\n        this.message = \"\"\n      }\n    },\n    async getChatRoomUsers () {\n      try {\n        this.isLoading = true\n        const data = await chatAPI.getOnlineUsers()\n\n        if (data.status === 'error') {\n          throw new Error(data.message)\n        }\n\n        this.onlineUsers = data.data\n        this.isLoading = false\n      } catch (error) {\n        this.isLoading = false\n        console.error(error.message)\n      }\n    },\n    async fetchMessages () {\n      try {\n        this.isLoading = true\n        const data = await chatAPI.getPublicChat()\n\n        if (data.status === 'error') {\n          throw new Error(data.message)\n        }\n\n        const messagesData = data.data\n        messagesData.map(d => {\n          this.messages.push({\n            id: d.id,\n            message: d.message,\n            time: d.createdAt,\n            userId: d.userId,\n            name: d.name,\n            avatar: d.avatar\n          })\n        })\n        this.isLoading = false\n      } catch (error) {\n        this.isLoading = false\n        Toast.fire({\n          icon: 'error',\n          title: 'Cannot get messages. Please wait for a moment'\n        })\n        console.error(error.message)\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"sass\">\n#chatModal\n  display: grid\n  grid-template-columns: 30vw 50vw\n  height: 100vh\n  overflow: hidden\n  #rooms\n    margin-top: 10px 0\n    background-color: #f1f7fd\n    border-radius: 10px\n    height: 100%\n    h5\n      font-size: 24px\n      margin: 10px\n    .room\n      display: flex\n      border: 1px solid rgba(grey,0.2)\n      &:hover\n        cursor: pointer\n      .avatar\n        width: 50px\n        height: 50px\n        border-radius: 50px\n        background-color: grey\n        margin: 10px\n      .name\n        line-height: 70px\n  #chatting\n    overflow-y: auto\n    padding-bottom: 40px\n    .message\n      display: flex\n      padding: 10px\n      padding-left: 0px\n      .avatar\n        width: 50px\n        height: 50px\n        border-radius: 50px\n        background-color: grey\n        margin: 10px\n      .right\n        width: 100%\n        display: flex\n        flex-flow: column nowrap\n        align-items: flex-start\n        .msg\n          background-color: #f1f7fd\n          padding: 10px\n          border-radius: 30px 30px 30px 0\n          white-space: normal\n          max-width: 60%\n        .time\n          font-size: 12px\n          color: grey\n        &.currentUser\n          align-items: flex-end\n          .msg\n            border-radius: 30px 30px 0 30px\n    form\n      position: fixed\n      bottom: 0\n      right: 0\n      padding: 10px\n      display: flex\n      align-items: center\n      background-color: #fff\n      input\n        width: 40vw\n        line-height: 30px\n        padding-left: 10px\n        border-radius: 30px\n      button\n        bottom: 0\n        right: 0\n        background: none\n        border: none\n        img\n          width: 30px\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./chatModal.vue?vue&type=template&id=3a9e0bea&\"\nimport script from \"./chatModal.vue?vue&type=script&lang=js&\"\nexport * from \"./chatModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chatModal.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"mainframe\">\n    <mainLeft/>\n    <chatModal/>\n  </div>\n</template>\n\n<script>\nimport mainLeft from '../components/mainLeft'\nimport chatModal from '../components/chatModal'\nexport default {\n  components: {\n    mainLeft,\n    chatModal,\n  },\n}\n</script>\n\n<style lang=\"sass\">\n#mainframe\n  width: 100vw\n  height: 100vh\n  display: grid\n  grid-template:\n    columns: 20vw 1fr\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatRoom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./chatRoom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./chatRoom.vue?vue&type=template&id=fc3a3154&\"\nimport script from \"./chatRoom.vue?vue&type=script&lang=js&\"\nexport * from \"./chatRoom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chatRoom.vue?vue&type=style&index=0&lang=sass&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}