(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4248ff33"],{"222b":function(t,e,s){},"27e3":function(t,e,s){t.exports=s.p+"img/like.ff95c713.png"},"882f":function(t,e,s){"use strict";s("222b")},9621:function(t,e,s){"use strict";s("f034")},a8ec:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"replyframe"}},[s("mainLeft"),s("mainMidReply"),s("mainRightFollow"),s("newTweet"),s("userReplyModal")],1)},a=[],n=s("fb77"),r=s("a16e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"mainMidReply"}},[i("div",{staticClass:"back"},[i("a",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("←")])]),i("div",{staticClass:"article",class:{one:0===t.replies.length}},[t.isLoading?i("Spinner"):t._e(),i("div",{staticClass:"info"},[i("div",{staticClass:"left"},[i("router-link",{attrs:{to:{name:"others",params:{id:t.tweet.UserId}}}},[i("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(t.tweet.avatar),alt:"tweet.avatar"}})])],1),i("div",{staticClass:"right"},[i("router-link",{attrs:{to:{name:"others",params:{id:t.tweet.UserId}}}},[i("div",{staticClass:"name"},[t._v(t._s(t.tweet?t.tweet.name:"Unknown"))]),i("div",{staticClass:"account"},[t._v("@"+t._s(t.tweet?t.tweet.account:"unknown"))])])],1)]),i("p",{staticClass:"description"},[t._v(t._s(t.tweet?t.tweet.description:""))]),i("div",{staticClass:"createTime"},[t._v(t._s(t._f("formatDate")(t.tweet.createdAt)))]),i("div",{staticClass:"count"},[i("div",{staticClass:"reply"},[t._v(t._s(t.tweet?t.tweet.replyCount:0)+" replies")]),i("div",{staticClass:"like"},[t._v(t._s(t.tweet?t.tweet.likeCount:0)+" likes")])]),i("div",{staticClass:"icons"},[i("img",{attrs:{src:s("b816")},on:{click:function(e){return t.reply(t.tweet)}}}),[i("img",{directives:[{name:"show",rawName:"v-show",value:!t.tweet.isLiked,expression:"!tweet.isLiked"}],attrs:{src:s("27e3")},on:{click:function(e){return t.handleLike(t.tweet.id)}}}),i("img",{directives:[{name:"show",rawName:"v-show",value:t.tweet.isLiked,expression:"tweet.isLiked"}],attrs:{src:s("b4f8")},on:{click:function(e){return t.handleUnlike(t.tweet.id)}}})]],2)],1),i("div",{staticClass:"replies"},t._l(t.replies,(function(e){return i("div",{key:e.id,staticClass:"reply"},[i("div",{staticClass:"left"},[i("router-link",{attrs:{to:{name:"others",params:{id:e.User.id}}}},[i("img",{staticClass:"avatar",attrs:{src:t._f("emptyImage")(e.User.avatar),alt:"tweet.avatar"}})])],1),i("div",{staticClass:"right"},[i("router-link",{attrs:{to:{name:"others",params:{id:e.User.id}}}},[i("div",{staticClass:"name"},[t._v(t._s(e?e.User.name:"Unknown")+" "),i("span",{staticClass:"account"},[t._v("@"+t._s(e?e.User.account:"unknown"))]),i("span",{staticClass:"creatTime"},[t._v("·"+t._s(t._f("fromNow")(e.createdAt)))])])]),i("div",{staticClass:"replyAt"},[t._v("replies to "),i("span",[t._v("@"+t._s(t.tweet?t.tweet.name:"Unknown"))])]),i("p",{staticClass:"description"},[t._v(t._s(e?e.comment:""))])],1)])})),0)])},c=[],l=s("f5ef"),d=s("6783"),m=s("2708"),u=s("9348"),w=s("2fa3"),p={mixins:[m["a"],m["c"],m["b"]],components:{Spinner:u["a"]},data(){return{isLoading:!0,isLikeClicked:!1,isUnikeClicked:!1,tweet:{},replies:[]}},created(){const{tweetId:t}=this.$route.params;this.fetchTweet(t),l["a"].$on("replySuccess",()=>{this.fetchTweet(t)})},beforeRouteUpdate(t,e,s){const{tweetId:i}=t.params;this.fetchTweet(i),s()},methods:{reply(t){l["a"].$emit("toreply",t)},async fetchTweet(t){try{this.isLoading=!0;const{data:e}=await d["a"].getTweet({tweetId:t});if("error"===e.status)throw new Error(e.message);const{User:s,Replies:i,UserId:a}=e,{id:n,description:r,createdAt:o,replyCount:c,likeCount:l,isLiked:m}=e,{avatar:u,name:w,account:p}=s;this.tweet={...this.tweet,id:n,description:r,createdAt:o,avatar:u,name:w,account:p,replyCount:c,likeCount:l,isLiked:m,UserId:a},this.replies=i,this.isLoading=!1}catch(e){this.isLoading=!1,console.error(e.message)}},async handleLike(t){try{if(this.isLikeClicked)return;if(this.isLikeClicked=!0,!t)return void w["a"].fire({icon:"warning",title:"This tweet does not exist"});const e=await d["a"].like({id:t});if("error"===e.status)throw new Error(e.message);w["a"].fire({icon:"success",title:"Liked"}),this.tweet.isLiked=!0,this.tweet.likeCount++,this.isLikeClicked=!1}catch(e){w["a"].fire({icon:"warning",title:"Please wait for a moment"}),this.isLikeClicked=!1,console.error(e.message)}},async handleUnlike(t){try{if(this.isUnikeClicked)return;if(this.isUnikeClicked=!0,!t)return void w["a"].fire({icon:"warning",title:"This tweet does not exist"});const e=await d["a"].unlike({id:t});if("error"===e.status)throw new Error(e.message);w["a"].fire({icon:"success",title:"Unliked"}),this.tweet.isLiked=!1,this.tweet.likeCount--,this.isUnikeClicked=!1}catch(e){w["a"].fire({icon:"warning",title:"Please wait for a moment"}),this.isUnikeClicked=!1,console.error(e.message)}}}},f=p,h=(s("882f"),s("2877")),v=Object(h["a"])(f,o,c,!1,null,null,null),k=v.exports,C=s("fb1a"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.modalOn,expression:"modalOn"}],attrs:{id:"userReplyModal"},on:{click:function(e){return e.target!==e.currentTarget?null:t.closeModal()}}},[s("div",{staticClass:"form",on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.replyTweet(e)}}},[s("div",{staticClass:"tweet"},[s("div",{staticClass:"left"},[s("img",{staticClass:"avatar",attrs:{src:t.tweet.avatar,alt:"tweet.avatar"}})]),s("div",{staticClass:"right"},[s("div",{staticClass:"name"},[t._v(t._s(t.tweet.name)+" "),s("span",{staticClass:"account"},[t._v("@"+t._s(t.tweet.account))]),s("span",{staticClass:"creatTime"},[t._v("·"+t._s(t._f("fromNow")(t.tweet.createdAt)))])]),s("p",{staticClass:"description"},[t._v(t._s(t.tweet.description))]),s("div",{staticClass:"tweetAt"},[t._v("Reply to "),s("span",[t._v("@"+t._s(t.tweet.name))])])])]),s("form",[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],attrs:{placeholder:"Tweet your reply"},domProps:{value:t.comment},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),e.stopPropagation(),e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.replyTweet(e))},input:function(e){e.target.composing||(t.comment=e.target.value)}}}),s("button",{staticClass:"button",class:{isProcessing:t.isProcessing},attrs:{type:"submit",disabled:t.isProcessing}},[t._v("Reply")]),s("div",{staticClass:"close",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeModal()}}},[t._v("×")])])])])},y=[],_={mixins:[m["c"]],data(){return{tweet:{},comment:"",tweetId:-1,modalOn:!1,isProcessing:!1}},created(){l["a"].$on("toreply",t=>{this.tweet=t,this.modalOn=!this.modalOn});const{tweetId:t}=this.$route.params;this.tweetId=t},methods:{closeModal(){this.comment?w["a"].fire({title:"Save Tweet?",position:"center",showDenyButton:!0,showConfirmButton:!0,confirmButtonText:"Save",denyButtonText:"Discard",timer:void 0}).then(t=>{t.isConfirmed?this.modalOn=!this.modalOn:t.isDenied&&(this.comment="",this.modalOn=!this.modalOn)}):this.modalOn=!this.modalOn},async replyTweet(){try{if(!this.comment)return void w["a"].fire({icon:"warning",title:"No character typed in"});this.isProcessing=!0;const{data:t}=await d["a"].replyTweet({tweetId:this.tweetId,comment:this.comment});if("error"===t.status)throw new Error(t.message);w["a"].fire({icon:"success",title:"Successfully tweeted"}),this.isProcessing=!1,this.modalOn=!this.modalOn,this.comment="",l["a"].$emit("replySuccess")}catch(t){this.isProcessing=!1,w["a"].fire({icon:"warning",title:"Cannot tweet your reply. Please wait for a moment"}),console.error(t.message)}}}},b=_,L=(s("b564"),Object(h["a"])(b,g,y,!1,null,null,null)),T=L.exports,U={components:{mainLeft:n["a"],mainRightFollow:r["a"],mainMidReply:k,newTweet:C["a"],userReplyModal:T}},x=U,O=(s("9621"),Object(h["a"])(x,i,a,!1,null,null,null));e["default"]=O.exports},b4f8:function(t,e,s){t.exports=s.p+"img/heart.b2bd73ca.png"},b564:function(t,e,s){"use strict";s("c236")},b816:function(t,e,s){t.exports=s.p+"img/reply.5a3f59a8.png"},c236:function(t,e,s){},f034:function(t,e,s){}}]);
//# sourceMappingURL=chunk-4248ff33.d1b99380.js.map