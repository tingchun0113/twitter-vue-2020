(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7bea8926"],{3256:function(e,s,t){"use strict";t("9022")},"44b9":function(e,s,t){e.exports=t.p+"img/send.bee9a967.png"},5936:function(e,s,t){},7325:function(e,s,t){"use strict";t("5936")},7856:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"mainframe"}},[t("mainLeft"),t("chatModal")],1)},i=[],r=t("fb77"),n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"chatModal"}},[t("div",{attrs:{id:"rooms"}},[t("h5",[e._v("Chats")]),e.isLoading?t("Spinner"):e._e(),e._l(e.onlineUsers,(function(s){return t("div",{key:s.id,staticClass:"room"},[t("img",{staticClass:"avatar",attrs:{src:e._f("emptyImage")(s.avatar),alt:"avatar"}}),t("div",{staticClass:"name"},[e._v(e._s(s.name))])])}))],2),t("div",{attrs:{id:"chatting"}},[e.isLoading?t("Spinner"):e._e(),e._l(e.messages,(function(s){return t("div",{key:s.id,staticClass:"message"},[s.userId!==e.currentUser.id?t("img",{staticClass:"avatar",attrs:{src:e._f("emptyImage")(s.avatar),alt:"avatar"}}):e._e(),t("div",{staticClass:"right",class:{currentUser:s.userId===e.currentUser.id}},[t("div",{staticClass:"msg"},[e._v(e._s(s.message))]),t("div",{staticClass:"time"},[e._v(e._s(e._f("fromNow")(s.time)))])])])})),t("form",{on:{submit:function(s){return s.stopPropagation(),s.preventDefault(),e.sendMessage(s)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{type:"text",placeholder:"Aa"},domProps:{value:e.message},on:{input:function(s){s.target.composing||(e.message=s.target.value)}}}),e._m(0)])],2)])},o=[function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("button",[a("img",{attrs:{src:t("44b9"),alt:"send"}})])}],c=t("2f62"),m=t("2708"),u=t("9348"),l=t("2fa3"),d={getPublicChat(){return l["b"].get("/chat/public")},getOnlineUsers(){return l["b"].get("/chat/public/online-users")}},g={mixins:[m["a"],m["c"]],components:{Spinner:u["a"]},computed:{...Object(c["b"])(["currentUser","isAuthenticated"])},created(){this.joinChatRoom(),this.sockets.subscribe("public-room-online",e=>{this.onlineUsers=e.onlineUsers}),this.getChatRoomUsers(),this.sockets.subscribe("public",e=>{this.messages.push({id:e.id,message:e.message,time:e.time,userId:e.userId,name:e.name,avatar:e.avatar})}),this.fetchMessages()},data(){return{message:"",messages:[],isLoading:!0,onlineUsers:[]}},methods:{joinChatRoom(){this.$socket.emit("public-room-online",this.currentUser.id)},sendMessage(){if(!this.message.trim())return l["a"].fire({icon:"warning",title:"No message typed in chat"}),void(this.message="");this.$socket.emit("public",{text:this.message,userId:this.currentUser.id}),this.message=""},async getChatRoomUsers(){try{this.isLoading=!0;const e=await d.getOnlineUsers();if("error"===e.status)throw new Error(e.message);this.onlineUsers=e.data,this.isLoading=!1}catch(e){this.isLoading=!1,console.error(e.message)}},async fetchMessages(){try{this.isLoading=!0;const e=await d.getPublicChat();if("error"===e.status)throw new Error(e.message);const s=e.data;s.map(e=>{this.messages.push({id:e.id,message:e.message,time:e.createdAt,userId:e.userId,name:e.name,avatar:e.avatar})}),this.isLoading=!1}catch(e){this.isLoading=!1,l["a"].fire({icon:"error",title:"Cannot get messages. Please wait for a moment"}),console.error(e.message)}}}},h=g,p=(t("7325"),t("2877")),f=Object(p["a"])(h,n,o,!1,null,null,null),v=f.exports,b={components:{mainLeft:r["a"],chatModal:v}},_=b,w=(t("3256"),Object(p["a"])(_,a,i,!1,null,null,null));s["default"]=w.exports},9022:function(e,s,t){}}]);
//# sourceMappingURL=chunk-7bea8926.58cad0bf.js.map